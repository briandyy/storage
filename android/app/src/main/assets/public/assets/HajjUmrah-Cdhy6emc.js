import{e as H,f as v,j as t,h as I,i as ae,U as ne,k as le}from"./index-Co3lyjy0.js";import{r}from"./vendor-react-CaYZq_vZ.js";import{A as ie}from"./AudioControlPanel-9qJEFhXi.js";import{u as ce}from"./vendor-i18n-BjjXjqrR.js";function he(){const{t:c,i18n:F}=ce(),m=F.language==="en",[h,J]=r.useState("doa"),[M,D]=r.useState(null),[q,P]=r.useState(null),[G,N]=r.useState(null),[w,O]=r.useState("all"),[S,W]=r.useState(""),[p,k]=r.useState(null),[z,C]=r.useState(!1),[u,x]=r.useState(!1),[B,_]=r.useState(0),[K,Q]=r.useState(0),[y]=r.useState(1),[g,E]=r.useState(0),[j,V]=r.useState(1),[f,X]=r.useState({}),[A,$]=r.useState(null),l=r.useRef(null),L=h==="hajj"?ae:ne,T=H.filter(e=>w!=="all"&&e.category!==w?!1:S?e.name.toLowerCase().includes(S.toLowerCase()):!0),Y=[...new Set(H.map(e=>e.category))],U=r.useCallback(async e=>{if(f[e])return f[e];$(e);try{const[s,a,n,i]=await Promise.all([fetch(v(e,"arab")).then(o=>o.text()),fetch(v(e,"translit")).then(o=>o.text()),fetch(v(e,"indonesia")).then(o=>o.text()),fetch(v(e,"english")).then(o=>o.text())]),d={arab:s,translit:a,indonesia:n,english:i};return X(o=>({...o,[e]:d})),d}catch(s){return console.error("Failed to load transcripts:",s),null}finally{$(null)}},[f]),R=e=>{if(l.current){if(p===e){u?(l.current.pause(),x(!1)):(l.current.play(),x(!0));return}k(e),C(!0),E(0),l.current.src=le(e,"arab"),l.current.playbackRate=j,l.current.play(),x(!0),U(e)}};r.useEffect(()=>{const e=l.current;if(!e)return;const s=()=>_(e.currentTime),a=()=>Q(e.duration),n=()=>x(!0),i=()=>x(!1),d=()=>{g<y-1?(E(o=>o+1),e.currentTime=0,e.play()):(x(!1),C(!1),k(null),E(0))};return e.addEventListener("timeupdate",s),e.addEventListener("durationchange",a),e.addEventListener("play",n),e.addEventListener("pause",i),e.addEventListener("ended",d),()=>{e.removeEventListener("timeupdate",s),e.removeEventListener("durationchange",a),e.removeEventListener("play",n),e.removeEventListener("pause",i),e.removeEventListener("ended",d)}},[g,y]),r.useEffect(()=>{l.current&&(l.current.playbackRate=j)},[j]);const Z=()=>{const e=[.5,.75,1,1.25,1.5,2],s=e.indexOf(j);V(e[(s+1)%e.length])},ee=(e,s)=>{const a=G===e,n=p===e&&u,i=f[e];return t.jsxs("div",{className:"my-3 rounded-xl border border-primary/30 overflow-hidden bg-primary/5",children:[t.jsxs("button",{onClick:d=>{d.stopPropagation(),N(a?null:e),a||U(e)},className:"w-full p-3 flex items-center gap-3 hover:bg-primary/10 transition-colors",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center shrink-0",children:t.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"auto_stories"})}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("p",{className:"text-sm font-medium text-primary",children:e}),t.jsx("p",{className:"text-secondary text-sm",children:c("hajjUmrah.clickToListen")})]}),t.jsx("button",{onClick:d=>{d.stopPropagation(),R(e)},className:`w-8 h-8 rounded-lg flex items-center justify-center shrink-0 ${n?"bg-primary text-black":"bg-primary/20 text-primary hover:bg-primary/30"}`,children:t.jsx("span",{className:"material-symbols-outlined text-lg",children:n?"pause":"play_arrow"})}),t.jsx("span",{className:`material-symbols-outlined text-text-secondary transition-transform ${a?"rotate-180":""}`,children:"expand_more"})]}),a&&t.jsx("div",{className:"p-3 pt-0 space-y-2 border-t border-primary/20",children:A===e?t.jsx("div",{className:"flex items-center justify-center py-4",children:t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-primary border-t-transparent"})}):i?t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"font-arabic text-xl leading-loose text-white text-right pt-3",dir:"rtl",children:i.arab}),t.jsx("p",{className:"text-primary text-sm italic",children:i.translit}),t.jsx("p",{className:"text-text-secondary text-sm",children:m?i.english:i.indonesia})]}):null})]})},te=(e,s)=>{const a=e.split(`

`);return a.map((n,i)=>{const d=n.replace(/\*\*(.*?)\*\*/g,'<strong class="text-white font-semibold">$1</strong>'),o=s.filter(b=>n.toLowerCase().includes(b.toLowerCase())||n.toLowerCase().includes(b.split(" ").slice(-1)[0].toLowerCase()));return t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-text-secondary leading-relaxed whitespace-pre-line",dangerouslySetInnerHTML:{__html:d}}),i===a.length-1&&o.length>0&&t.jsx("div",{className:"mt-3 space-y-2",children:s.map(b=>ee(b))})]},i)})},se=e=>{const s=M===e.id,a=m?e.descriptionEn:e.descriptionId;return t.jsxs("div",{className:`surface-card overflow-hidden transition-all ${s?"ring-1 ring-primary/50":""}`,children:[t.jsxs("div",{className:"p-4 md:p-5 flex items-start gap-4 cursor-pointer hover:bg-white/5 transition-colors",onClick:()=>{D(s?null:e.id),N(null)},children:[t.jsxs("div",{className:"relative shrink-0",children:[t.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-primary to-primary/70 text-black font-bold text-xl flex items-center justify-center shadow-lg shadow-primary/20",children:e.id}),e.id<L.length&&!s&&t.jsx("div",{className:"absolute left-1/2 top-full w-0.5 h-3 bg-border-dark -translate-x-1/2"})]}),t.jsxs("div",{className:"flex-1 min-w-0 pt-1",children:[t.jsx("h3",{className:"font-bold text-lg text-white mb-1",children:m?e.titleEn:e.titleId}),t.jsx("p",{className:"text-sm text-text-secondary line-clamp-2",children:a.split(`
`)[0].replace(/\*\*/g,"")}),t.jsx("div",{className:"flex items-center gap-2 mt-2",children:t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-md bg-primary/10 text-primary text-xs",children:[t.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"}),c("hajjUmrah.duasCount",{count:e.relatedDoa.length})]})})]}),t.jsx("div",{className:`w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center shrink-0 transition-transform ${s?"rotate-180":""}`,children:t.jsx("span",{className:"material-symbols-outlined text-text-secondary",children:"expand_more"})})]}),s&&t.jsx("div",{className:"border-t border-border-dark p-4 md:p-5",children:t.jsx("div",{className:"prose prose-invert prose-sm max-w-none",children:te(a,e.relatedDoa)})})]},e.id)},re=e=>{const s=q===e.id,a=p===e.name&&u,n=f[e.name];return t.jsxs("div",{className:"surface-card overflow-hidden",children:[t.jsxs("div",{className:"p-4 flex items-center gap-4 cursor-pointer hover:bg-white/5",onClick:()=>{P(s?null:e.id),s||U(e.name)},children:[t.jsx("button",{onClick:i=>{i.stopPropagation(),R(e.name)},className:`w-12 h-12 rounded-xl flex items-center justify-center shrink-0 ${a?"bg-primary text-black":"bg-primary/20 text-primary hover:bg-primary/30"}`,children:t.jsx("span",{className:"material-symbols-outlined",children:a?"pause":"play_arrow"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"font-semibold text-white truncate",children:e.name}),t.jsx("p",{className:"text-sm text-text-secondary",children:I(e.category,m?"en":"id")})]}),t.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.forHajj&&t.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-primary/20 text-primary",children:"Haji"}),e.forUmrah&&t.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-blue-500/20 text-blue-400",children:"Umrah"})]}),t.jsx("span",{className:`material-symbols-outlined text-text-secondary transition-transform ${s?"rotate-180":""}`,children:"expand_more"})]}),s&&t.jsx("div",{className:"border-t border-border-dark p-4 space-y-3",children:A===e.name?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary border-t-transparent"})}):n?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-surface-dark-2 rounded-xl p-4",children:t.jsx("p",{className:"font-arabic text-2xl leading-loose text-white text-right",dir:"rtl",children:n.arab})}),t.jsx("p",{className:"text-primary italic",children:n.translit}),t.jsx("p",{className:"text-text-secondary",children:m?n.english:n.indonesia})]}):t.jsx("p",{className:"text-text-secondary text-center py-4",children:c("common.error")})})]},e.id)};return t.jsxs("main",{className:"flex-1 flex justify-center py-6 md:py-10 px-4 md:px-10 lg:px-40 overflow-x-hidden",children:[t.jsxs("div",{className:"flex flex-col w-full max-w-[1024px] flex-1 gap-6 overflow-hidden",children:[t.jsx("audio",{ref:l,preload:"metadata"}),t.jsxs("div",{className:"text-center",children:[t.jsx("h1",{className:"text-3xl md:text-4xl font-black tracking-tight mb-2",children:c("hajjUmrah.title")}),t.jsx("p",{className:"text-text-secondary",children:c("hajjUmrah.subtitle")})]}),t.jsx("div",{className:"flex gap-2 bg-surface-dark p-1 rounded-xl",children:["doa","hajj","umrah"].map(e=>t.jsxs("button",{onClick:()=>{J(e),D(null),P(null),N(null)},className:`flex-1 py-3 px-4 rounded-lg font-medium transition-all flex items-center justify-center gap-2 ${h===e?"bg-primary text-black":"text-text-secondary hover:text-white"}`,children:[t.jsx("span",{className:"material-symbols-outlined text-[20px]",children:e==="doa"?"auto_stories":e==="hajj"?"hiking":"mosque"}),e==="doa"?"Doa":e==="hajj"?"Haji":"Umrah"]},e))}),h==="doa"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"surface-card p-4 flex flex-col md:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"flex w-full items-stretch rounded-lg h-12 bg-border-dark",children:[t.jsx("div",{className:"flex items-center justify-center pl-4 text-text-secondary",children:t.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"search"})}),t.jsx("input",{type:"text",placeholder:c("hajjUmrah.searchPlaceholder"),value:S,onChange:e=>W(e.target.value),className:"flex-1 bg-transparent px-4 text-white placeholder:text-text-secondary outline-none"})]})}),t.jsxs("select",{value:w,onChange:e=>O(e.target.value),className:"h-12 px-4 rounded-lg bg-border-dark text-white outline-none cursor-pointer",children:[t.jsx("option",{value:"all",children:c("hajjUmrah.allCategories")}),Y.map(e=>t.jsx("option",{value:e,children:I(e,m?"en":"id")},e))]})]}),t.jsx("p",{className:"text-text-secondary text-sm",children:c("hajjUmrah.duasFound",{count:T.length})}),t.jsxs("div",{className:"flex flex-col gap-3",children:[T.map(e=>re(e)),T.length===0&&t.jsxs("div",{className:"surface-card p-8 text-center",children:[t.jsx("span",{className:"material-symbols-outlined text-5xl text-text-secondary mb-4",children:"search_off"}),t.jsx("p",{className:"text-text-secondary",children:c("hajjUmrah.noResults")})]})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"surface-card p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/20 flex items-center justify-center text-primary shrink-0",children:t.jsx("span",{className:"material-symbols-outlined text-2xl",children:h==="hajj"?"hiking":"mosque"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"font-semibold text-white",children:c(h==="hajj"?"hajjUmrah.hajjGuide":"hajjUmrah.umrahGuide")}),t.jsx("p",{className:"text-sm text-text-secondary",children:c("hajjUmrah.stepsCount",{count:L.length})})]})]}),t.jsx("div",{className:"flex flex-col gap-3",children:L.map(e=>se(e))})]})]}),t.jsx(ie,{show:z&&!!p,title:p||"",subtitle:`${c("hajjUmrah.repeat")}: ${g+1} / ${y}`,icon:"auto_stories",currentTime:B,duration:K,isPlaying:u,onSeek:e=>{l.current&&(l.current.currentTime=e,_(e))},onTogglePlay:()=>{l.current&&(u?l.current.pause():l.current.play())},onStop:()=>{var e;(e=l.current)==null||e.pause(),C(!1),k(null),x(!1)},playbackSpeed:j,onSpeedChange:Z,repeatInfo:{current:g+1,total:y}})]})}export{he as default};
