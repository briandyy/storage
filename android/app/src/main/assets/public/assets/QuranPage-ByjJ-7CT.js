import{j as e,S as L,Q as he,a as De}from"./index-Co3lyjy0.js";import{e as ze,f as Be,r as n,L as re}from"./vendor-react-CaYZq_vZ.js";import{E as Oe}from"./ErrorState-DCEne8_7.js";import{u as be}from"./vendor-i18n-BjjXjqrR.js";const ve="https://cdn.briandy.me/mushaf-data",le=new Map;let ne=null;async function Ne(r){if(le.has(r))return le.get(r);if(r<1||r>604)throw new Error(`Invalid page number: ${r}. Must be between 1 and 604.`);const u=String(r).padStart(3,"0"),i=`${ve}/page-${u}.json`;try{const x=await fetch(i);if(!x.ok)throw new Error(`Failed to fetch page ${r}`);const c=await x.json();return le.set(r,c),c}catch(x){throw console.error(`Error fetching mushaf page ${r}:`,x),x}}async function Qe(){if(ne)return ne;try{const r=await fetch(`${ve}/surah-page-map.json`);if(!r.ok)throw new Error("Failed to fetch surah page map");return ne=await r.json(),ne}catch(r){throw console.error("Error fetching surah page map:",r),r}}function He(r){[r-1,r+1].filter(i=>i>=1&&i<=604&&!le.has(i)).forEach(i=>{Ne(i).catch(()=>{})})}function P(r){const[u,i]=r.split(":").map(Number);return{surah:u,ayat:i}}const Ue="https://equran.id";async function Ve(r,u={}){if(!r||r.length<2)return[];try{const i={cari:r};u.limit&&(i.batas=u.limit),u.types&&u.types.length>0&&(i.tipe=u.types.join(",")),u.minScore!==void 0&&(i.skorMin=u.minScore);const x=await fetch(`${Ue}/api/vector`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!x.ok)return console.error("Search API error:",x.status),[];const c=await x.json();return c.status!=="sukses"||!c.hasil?(console.error("Search API returned error:",c),[]):c.hasil.map(o=>{const m=o.relevansi==="tinggi"?"high":o.relevansi==="sedang"?"medium":"low";return{type:o.tipe,score:o.skor,relevance:m,data:{surah:o.data.id_surat||0,surahName:o.data.nama||o.data.nama_surat||"",surahArabic:o.data.nama_arab||o.data.nama_surat_arab||"",ayat:o.data.nomor_ayat||0,text:o.data.teks_arab||"",textLatin:o.data.teks_latin||"",translation:o.data.terjemahan_id||o.data.arti||"",translationEn:o.data.terjemahan_en||"",tafsir:o.data.isi||"",description:o.data.deskripsi||""}}})}catch(i){return console.error("Search API error:",i),[]}}function We(){return e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx("div",{className:"spinner size-12"})})}const xe={1:"The Opening",2:"The Cow",3:"The Family of Imran",4:"The Women",5:"The Table Spread",6:"The Cattle",7:"The Heights",8:"The Spoils of War",9:"The Repentance",10:"Jonah",11:"Hud",12:"Joseph",13:"The Thunder",14:"Abraham",15:"The Rocky Tract",16:"The Bee",17:"The Night Journey",18:"The Cave",19:"Mary",20:"Ta-Ha",21:"The Prophets",22:"The Pilgrimage",23:"The Believers",24:"The Light",25:"The Criterion",26:"The Poets",27:"The Ants",28:"The Stories",29:"The Spider",30:"The Romans",31:"Luqman",32:"The Prostration",33:"The Confederates",34:"Sheba",35:"The Originator",36:"Ya-Sin",37:"Those Ranged in Ranks",38:"Sad",39:"The Groups",40:"The Forgiver",41:"Explained in Detail",42:"The Consultation",43:"The Gold Adornment",44:"The Smoke",45:"The Kneeling",46:"The Curved Sand-hills",47:"Muhammad",48:"The Victory",49:"The Rooms",50:"Qaf",51:"The Winnowing Winds",52:"The Mount",53:"The Star",54:"The Moon",55:"The Most Gracious",56:"The Inevitable",57:"The Iron",58:"The Pleading Woman",59:"The Exile",60:"The Woman to be Examined",61:"The Battle Array",62:"Friday",63:"The Hypocrites",64:"The Mutual Loss and Gain",65:"The Divorce",66:"The Prohibition",67:"The Sovereignty",68:"The Pen",69:"The Reality",70:"The Ways of Ascent",71:"Noah",72:"The Jinn",73:"The Enshrouded One",74:"The Cloaked One",75:"The Resurrection",76:"Man",77:"Those Sent Forth",78:"The Tidings",79:"Those Who Pull Out",80:"He Frowned",81:"The Overthrowing",82:"The Cleaving",83:"The Defrauders",84:"The Splitting Asunder",85:"The Great Star",86:"The Night-Comer",87:"The Most High",88:"The Overwhelming",89:"The Dawn",90:"The City",91:"The Sun",92:"The Night",93:"The Forenoon",94:"The Expansion",95:"The Fig",96:"The Clot",97:"The Night of Power",98:"The Clear Evidence",99:"The Earthquake",100:"The Chargers",101:"The Striking Hour",102:"The Piling Up",103:"Time",104:"The Slanderer",105:"The Elephant",106:"Quraysh",107:"Small Kindnesses",108:"Abundance",109:"The Disbelievers",110:"The Help",111:"The Palm Fiber",112:"The Sincerity",113:"The Daybreak",114:"Mankind"};function ea({view:r="home"}){return r==="mushaf"?e.jsx(Ge,{}):e.jsx(Ke,{})}function Ke(){const{t:r,i18n:u}=be(),i=u.language==="id",[x,c]=n.useState(""),[o,m]=n.useState("all"),[p,K]=n.useState("surah"),[I,G]=n.useState([]),[F,J]=n.useState(!1),[X,b]=n.useState(""),w=(s,j)=>!i&&xe[s]?xe[s]:j,N=s=>i?s:s==="Mekah"?"Mecca":"Medina",D=s=>s.toLowerCase().replace(/[-'`\u2018\u2019]/g,"").replace(/\s+/g,"").replace(/aa/g,"a").replace(/ii/g,"i").replace(/uu/g,"u"),E=(s,j)=>{const y=D(s),z=D(j);return y.includes(z)||z.includes(y)},_=L.filter(s=>{var B;const j=x.toLowerCase().trim();if(!j)return o==="all"||s.tempatTurun.toLowerCase()===o;const y=s.namaLatin.toLowerCase().includes(j)||s.arti.toLowerCase().includes(j)||s.nomor.toString().includes(x)||s.nama.includes(x),z=E(s.namaLatin,x),ie=(xe[s.nomor]||"").toLowerCase().includes(j),ce=(B={56:["hari kiamat","kiamat","doom","doomsday","inevitable"],36:["yasin","heart of quran","jantung quran"],1:["al fatihah","alfatihah","pembukaan","opening"],2:["sapi","cow"],112:["ikhlas","sincerity","tauhid"],114:["manusia","mankind","people"],113:["subuh","dawn","daybreak"],18:["cave","gua","kahfi"],55:["rahman","gracious","beneficent"]}[s.nomor])==null?void 0:B.some(O=>j.includes(O)||O.includes(j));return(y||z||ie||ce)&&(o==="all"||s.tempatTurun.toLowerCase()===o)}),$=async()=>{if(x.trim()){J(!0),b("");try{const s=await Ve(x,{limit:15});G(s),s.length===0&&b(r("quran.home.noResults"))}catch(s){console.error("Semantic search error:",s),b(r("common.error"))}finally{J(!1)}}},Y=s=>{s.key==="Enter"&&p==="semantic"&&$()};return e.jsx("main",{className:"flex-1 flex justify-center py-6 md:py-10 px-4 md:px-10 lg:px-40",children:e.jsxs("div",{className:"flex flex-col max-w-[1200px] flex-1 gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-arabic text-4xl md:text-5xl text-primary mb-4",children:"الْقُرْآنُ الْكَرِيمُ"}),e.jsx("h1",{className:"text-3xl md:text-4xl font-black tracking-tight mb-2",children:r("quran.home.title")}),e.jsx("p",{className:"text-text-secondary",children:r("quran.home.subtitle")})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2 md:gap-4",children:[{value:"114",label:r("quran.surah")},{value:"6.236",label:r("quran.verses")},{value:"30",label:r("quran.juz")},{value:"5",label:r("quran.qari")}].map(s=>e.jsxs("div",{className:"surface-card p-3 md:p-4 text-center",children:[e.jsx("div",{className:"text-xl md:text-2xl font-bold text-primary",children:s.value}),e.jsx("div",{className:"text-xs text-text-secondary",children:s.label})]},s.label))}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(re,{to:"/quran/mushaf",className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-amber-600 to-amber-700 hover:from-amber-700 hover:to-amber-800 text-white rounded-xl font-medium transition-all shadow-lg hover:shadow-xl",children:[e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"menu_book"}),e.jsx("span",{children:r("quran.mushafMode")}),e.jsxs("span",{className:"text-amber-200 text-sm",children:["(",r("quran.rasmUthmani"),")"]})]})}),e.jsxs("div",{className:"flex h-10 items-center justify-center rounded-lg bg-border-dark p-1 max-w-md mx-auto",children:[e.jsxs("label",{className:`flex cursor-pointer h-full px-4 items-center justify-center rounded-md text-sm font-medium transition-all ${p==="surah"?"bg-bg-dark text-white shadow-sm":"text-text-secondary hover:text-white"}`,children:[e.jsx("span",{className:"material-symbols-outlined text-[18px] mr-1",children:"book"}),e.jsx("span",{children:r("quran.surah")}),e.jsx("input",{type:"radio",name:"searchMode",value:"surah",checked:p==="surah",onChange:()=>K("surah"),className:"sr-only"})]}),e.jsxs("label",{className:`flex cursor-pointer h-full px-4 items-center justify-center rounded-md text-sm font-medium transition-all ${p==="semantic"?"bg-bg-dark text-white shadow-sm":"text-text-secondary hover:text-white"}`,children:[e.jsx("span",{className:"material-symbols-outlined text-[18px] mr-1",children:"search"}),e.jsx("span",{children:r("quran.searchByMeaning")}),e.jsx("input",{type:"radio",name:"searchMode",value:"semantic",checked:p==="semantic",onChange:()=>K("semantic"),className:"sr-only"})]})]}),e.jsx("div",{className:"surface-card p-4 md:p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex w-full items-stretch rounded-lg h-12",children:[e.jsx("div",{className:"text-text-secondary flex bg-border-dark items-center justify-center pl-4 rounded-l-lg",children:e.jsx("span",{className:"material-symbols-outlined",children:"search"})}),e.jsx("input",{className:"flex w-full flex-1 resize-none overflow-hidden rounded-none border-none bg-border-dark text-white focus:outline-none h-full placeholder:text-text-secondary px-4 pl-2 text-sm",placeholder:r(p==="semantic"?"quran.searchByMeaningPlaceholder":"quran.home.searchPlaceholder"),value:x,onChange:s=>c(s.target.value),onKeyDown:Y}),p==="semantic"&&e.jsx("button",{onClick:$,disabled:F||!x.trim(),className:"px-4 bg-primary text-black font-medium rounded-r-lg hover:bg-primary-dark transition-colors disabled:opacity-50",children:F?e.jsx("span",{className:"material-symbols-outlined animate-spin",children:"progress_activity"}):e.jsx("span",{className:"material-symbols-outlined",children:"search"})}),p==="surah"&&e.jsx("div",{className:"rounded-r-lg bg-border-dark"})]}),p==="semantic"&&!i&&e.jsxs("p",{className:"text-xs text-amber-400 mt-2 flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"info"}),r("quran.searchByMeaningWarning")]})]}),p==="surah"&&e.jsx("div",{className:"flex h-10 md:h-12 items-center justify-center rounded-lg bg-border-dark p-1",children:["all","mekah","madinah"].map(s=>e.jsxs("label",{className:`flex cursor-pointer h-full px-4 items-center justify-center rounded-md text-sm font-medium transition-all ${o===s?"bg-bg-dark text-white shadow-sm":"text-text-secondary hover:text-white"}`,children:[e.jsx("span",{children:r(s==="all"?"quran.home.filter.all":s==="mekah"?"quran.home.filter.mekah":"quran.home.filter.madinah")}),e.jsx("input",{type:"radio",name:"filter",value:s,checked:o===s,onChange:()=>m(s),className:"sr-only"})]},s))})]})}),p==="semantic"&&I.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary",children:"auto_awesome"}),r("quran.searchResults")," (",I.length,")"]}),I.map((s,j)=>{var y;return e.jsx(re,{to:`/quran/${s.data.surah}${s.data.ayat>1?`#ayat-${s.data.ayat}`:""}`,className:"block surface-card p-4 hover:border-primary/30 transition-all",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center gap-1",children:[e.jsxs("span",{className:"size-10 rounded-lg bg-primary/20 text-primary flex items-center justify-center font-bold",children:[s.data.surah,":",s.data.ayat]}),e.jsxs("span",{className:"text-xs text-text-secondary",children:[Math.round(s.score*100),"%"]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-300 line-clamp-3",children:s.data.translation||s.data.description||s.data.tafsir||s.data.text||r("quran.noDescription")}),e.jsxs("p",{className:"text-xs text-primary mt-2",children:[s.data.surahName||((y=L[(s.data.surah||1)-1])==null?void 0:y.namaLatin)," • ",r("quran.verses")," ",s.data.ayat]})]})]})},`${s.data.surah}-${s.data.ayat}-${j}`)})]}),p==="semantic"&&X&&!F&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl text-text-secondary mb-2",children:"search_off"}),e.jsx("p",{className:"text-text-secondary",children:X})]}),p==="surah"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-text-secondary",children:r("quran.home.showingResults",{count:_.length,total:114})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:_.map(s=>e.jsxs(re,{to:`/quran/${s.nomor}`,className:"group flex items-center gap-3 p-4 rounded-xl bg-surface-dark border border-border-dark hover:border-primary/30 transition-all",children:[e.jsx("div",{className:"flex items-center justify-center size-10 rounded-lg bg-border-dark text-text-secondary font-bold text-sm group-hover:bg-primary group-hover:text-black transition-colors flex-shrink-0",children:s.nomor}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"font-semibold text-white group-hover:text-primary transition-colors truncate",children:s.namaLatin}),e.jsx("p",{className:"font-arabic text-xl text-text-secondary group-hover:text-white transition-colors flex-shrink-0 ml-2",children:s.nama})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs text-text-secondary",children:w(s.nomor,s.arti)}),e.jsx("span",{className:"size-1 rounded-full bg-text-secondary"}),e.jsxs("span",{className:"text-xs text-text-secondary",children:[s.jumlahAyat," ",r("quran.verses")]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${s.tempatTurun==="Mekah"?"bg-amber-500/20 text-amber-400":"bg-blue-500/20 text-blue-400"}`,children:N(s.tempatTurun)})]})]})]},s.nomor))}),_.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl text-text-secondary mb-4",children:"search_off"}),e.jsx("p",{className:"text-text-secondary",children:r("quran.home.noResults")})]})]})]})})}function Ge(){const{pageNumber:r}=ze(),u=Be(),{t:i}=be(),x=n.useRef(null),c=n.useRef(null),o=n.useRef(null),[m,p]=n.useState(null),[K,I]=n.useState(!0),[G,F]=n.useState(null),[J,X]=n.useState({}),[b,w]=n.useState(!1),[N,D]=n.useState(1),[E,_]=n.useState(1),[$,Y]=n.useState(0),[s,j]=n.useState(0),[y,z]=n.useState(()=>localStorage.getItem("selectedQari")||"05"),[v,ie]=n.useState(()=>parseFloat(localStorage.getItem("playbackSpeed")||"1")),[A,ce]=n.useState(()=>parseFloat(localStorage.getItem("audioVolume")||"1")),B=[.5,.75,1,1.25,1.5,2],[O,Z]=n.useState(!1),[fe,Te]=n.useState(""),[U,ee]=n.useState(!1),[Q,Se]=n.useState(()=>localStorage.getItem("mushafTajweed")!=="false"),[C,ke]=n.useState(!1),[we,T]=n.useState(!0),f=n.useRef(null),R=n.useRef(null),ae=n.useRef(!1),se=n.useRef(null),pe=n.useRef(null),[oe,de]=n.useState(null),h=parseInt(r||"1",10),Ce=(a,t)=>`${String(a).padStart(3,"0")}-${t}`,V=n.useCallback((a,t)=>{const l=L.find(M=>M.nomor===a);if(!l)return"";const d=Ce(l.nomor,l.namaLatin),g=he.find(M=>M.id===y);if(!g)return"";const k=String(a).padStart(3,"0"),q=String(t).padStart(3,"0");return`${De}/${d}/audio-ayat/${g.folder}/${k}-${q}-${g.folder}.mp3`},[y]),ge=n.useCallback(()=>V(1,1),[V]),je=n.useCallback((a,t,l)=>a===1||a===9||t!==1?!1:l,[]);n.useEffect(()=>{(async()=>{I(!0),F(null);try{const[t,l]=await Promise.all([Ne(h),Qe()]);if(p(t),X(l),t.verses.length>0){const{surah:d,ayat:g}=P(t.verses[0].verse_key);D(d),_(g)}He(h)}catch{F(i("quran.failedToLoadSurah"))}finally{I(!1)}})()},[h,i]);const te=n.useRef(!1),ue=n.useRef(null);n.useEffect(()=>{const a=()=>{te.current=!0,ue.current&&clearTimeout(ue.current),ue.current=setTimeout(()=>{if(te.current=!1,b){const l=document.querySelector(".ayat.playing");l&&l.scrollIntoView({behavior:"smooth",block:"center"})}},3e3)},t=["wheel","touchstart","touchmove","mousedown"];return t.forEach(l=>window.addEventListener(l,a,{passive:!0})),()=>t.forEach(l=>window.removeEventListener(l,a))},[b]),n.useEffect(()=>{if(!b||te.current)return;const a=setTimeout(()=>{if(te.current)return;const t=document.querySelector(".ayat.playing");t&&t.scrollIntoView({behavior:"smooth",block:"center"})},100);return()=>clearTimeout(a)},[N,E,b]),n.useEffect(()=>localStorage.setItem("mushafTajweed",String(Q)),[Q]),n.useEffect(()=>{localStorage.setItem("audioVolume",String(A)),c.current&&(c.current.volume=A)},[A]),n.useEffect(()=>{localStorage.setItem("playbackSpeed",String(v)),c.current&&(c.current.playbackRate=v)},[v]),n.useEffect(()=>localStorage.setItem("selectedQari",y),[y]),n.useEffect(()=>{const a=t=>{O||U||(t.key==="ArrowLeft"&&h<604?u(`/quran/mushaf/${h+1}`):t.key==="ArrowRight"&&h>1&&u(`/quran/mushaf/${h-1}`))};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[h,u,O,U]);const W=n.useCallback((a,t)=>{D(a),_(t);const l=V(a,t);if(c.current&&l&&(c.current.src=l,c.current.playbackRate=v,c.current.play().catch(d=>console.error(d)),w(!0),m)){const d=m.verses.findIndex(g=>{const{surah:k,ayat:q}=P(g.verse_key);return k===a&&q===t});if(d>=0&&d<m.verses.length-1){const g=m.verses[d+1],{surah:k,ayat:q}=P(g.verse_key),M=V(k,q);M&&(o.current||(o.current=new Audio),o.current.src=M,o.current.preload="auto",o.current.load())}}},[V,v,m]),H=n.useCallback((a,t,l=!1)=>{if(l&&je(a,t,!0)){de({surah:a,ayat:t}),D(a),_(t);const d=ge();c.current&&d&&(c.current.src=d,c.current.playbackRate=v,c.current.play(),w(!0))}else de(null),W(a,t)},[je,ge,W,v]),qe=n.useCallback(()=>{if(oe){const{surah:t,ayat:l}=oe;de(null),W(t,l);return}if(!m)return;const a=m.verses.findIndex(t=>{const{surah:l,ayat:d}=P(t.verse_key);return l===N&&d===E});if(a>=0&&a<m.verses.length-1){const t=m.verses[a+1],{surah:l,ayat:d}=P(t.verse_key);l!==N&&d===1&&l!==9?H(l,d,!0):W(l,d)}else h<604?u(`/quran/mushaf/${h+1}?autoplay=true`):w(!1)},[m,N,E,h,u,H,W,oe]),Me=n.useCallback(()=>{if(c.current)if(b)c.current.pause(),w(!1);else{if(c.current.src&&c.current.src!==window.location.href)c.current.play();else if(m!=null&&m.verses.length){const{surah:a,ayat:t}=P(m.verses[0].verse_key);H(a,t)}w(!0)}},[b,m,H]),Pe=n.useCallback(()=>{ke(a=>{var l,d,g;const t=!a;if(t){try{(d=(l=x.current)==null?void 0:l.requestFullscreen)==null||d.call(l)}catch{}T(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>T(!1),3e3)}else{try{(g=document.exitFullscreen)==null||g.call(document)}catch{}T(!0),f.current&&clearTimeout(f.current)}return t})},[]),Ee=n.useCallback(a=>{se.current=a.touches[0].clientX,pe.current=a.touches[0].clientY,ae.current=!1,C&&(R.current=setTimeout(()=>{ae.current=!0,T(t=>t?(f.current&&clearTimeout(f.current),!1):(f.current&&clearTimeout(f.current),f.current=setTimeout(()=>T(!1),3e3),!0))},500))},[C]),_e=n.useCallback(()=>{R.current&&(clearTimeout(R.current),R.current=null)},[]),$e=n.useCallback(a=>{if(R.current&&(clearTimeout(R.current),R.current=null),ae.current){ae.current=!1;return}if(se.current===null)return;const t=se.current-a.changedTouches[0].clientX;Math.abs(t)>80&&(t<0&&h<604?u(`/quran/mushaf/${h+1}`):t>0&&h>1&&u(`/quran/mushaf/${h-1}`)),se.current=null,pe.current=null},[h,u]),Ae=n.useCallback(a=>{C&&(a.target.closest(".audio-player-inner, .navbar, .ayat")||T(t=>t?(f.current&&clearTimeout(f.current),!1):(f.current&&clearTimeout(f.current),f.current=setTimeout(()=>T(!1),3e3),!0)))},[C]),Re=n.useCallback(()=>{C&&T(a=>a?(f.current&&clearTimeout(f.current),f.current=setTimeout(()=>T(!1),3e3),!0):!1)},[C]),ye=a=>{if(isNaN(a))return"0:00";const t=Math.floor(a/60),l=Math.floor(a%60);return`${t}:${l.toString().padStart(2,"0")}`},Le=a=>{const t=parseFloat(a.target.value);c.current&&(c.current.currentTime=t,Y(t))},Ie=a=>{const t=J[String(a)];t&&(u(`/quran/mushaf/${t.startPage}`),ee(!1))},S=L.find(a=>a.nomor===N)||L[0],me=he.find(a=>a.id===y),Fe=a=>String(a).split("").map(t=>["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"][parseInt(t)]).join("");return K?e.jsx(We,{}):G||!m?e.jsx("div",{className:"mushaf-container min-h-screen flex items-center justify-center",children:e.jsx(Oe,{message:G||i("quran.failedToLoadSurah"),onRetry:()=>window.location.reload()})}):e.jsxs("div",{className:`mushaf-container min-h-screen no-select ${C?"fullscreen":""} ${we?"show-controls":"hide-controls"}`,ref:x,onTouchStart:Ee,onTouchMove:_e,onTouchEnd:$e,onClick:Ae,onMouseMove:Re,onContextMenu:a=>a.preventDefault(),children:[e.jsx("audio",{ref:c,onEnded:qe,onTimeUpdate:()=>{c.current&&(Y(c.current.currentTime),j(c.current.duration||0))}}),U&&e.jsx("div",{className:"sidebar-overlay open",onClick:()=>ee(!1)}),e.jsxs("aside",{className:`sidebar ${U?"open":""}`,children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("span",{children:i("quran.surahList")}),e.jsx("button",{className:"sidebar-close",onClick:()=>ee(!1),children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsx("div",{className:"sidebar-list",children:L.map(a=>e.jsxs("div",{className:`sidebar-item ${a.nomor===N?"active":""}`,onClick:()=>Ie(a.nomor),children:[e.jsx("div",{className:"number",children:a.nomor}),e.jsxs("div",{className:"info",children:[e.jsx("div",{className:"title",children:a.namaLatin}),e.jsxs("div",{className:"subtitle",children:[a.arti," • ",a.jumlahAyat," ",i("quran.verses")]})]}),e.jsx("div",{className:"arabic",children:a.nama})]},a.nomor))})]}),e.jsxs("nav",{className:"navbar",children:[e.jsxs("div",{className:"navbar-brand",children:[e.jsx("button",{className:"menu-toggle",onClick:()=>ee(!U),children:e.jsx("span",{className:"material-symbols-outlined",children:"menu"})}),e.jsx("div",{className:"icon",children:e.jsx("span",{className:"material-symbols-outlined filled",children:"menu_book"})}),e.jsxs("div",{children:[e.jsx("h1",{children:i("quran.mushafMode")}),e.jsx("p",{children:i("quran.rasmUthmani")})]})]}),e.jsxs("div",{className:"navbar-right",children:[e.jsxs("div",{className:"page-indicator",children:[e.jsxs("span",{className:"juz-label",children:[i("quran.juz")," ",m.meta.juz]}),e.jsxs("span",{className:"page-label",children:[i("quran.page")," ",h]})]}),e.jsx("button",{className:`nav-btn ${Q?"active":""}`,onClick:()=>Se(!Q),children:e.jsx("span",{className:`material-symbols-outlined ${Q?"filled":""}`,children:"format_paint"})}),e.jsx("button",{className:"nav-btn",onClick:Pe,children:e.jsx("span",{className:"material-symbols-outlined",children:C?"fullscreen_exit":"fullscreen"})}),e.jsx("button",{className:"nav-btn",onClick:()=>Z(!0),children:e.jsx("span",{className:"material-symbols-outlined",children:"tune"})}),e.jsx(re,{to:"/quran",className:"nav-btn",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]})]}),e.jsxs("main",{className:"content",children:[e.jsx("div",{className:"mushaf-page-wrapper",children:e.jsxs("div",{className:"mushaf-card",children:[e.jsxs("div",{className:"mushaf-header",children:[e.jsxs("span",{className:"juz-badge",children:[i("quran.juz")," ",m.meta.juz]}),e.jsxs("span",{className:"surah-name",children:[S==null?void 0:S.namaLatin," ",e.jsx("span",{className:"surah-arabic",children:S==null?void 0:S.nama})]})]}),e.jsx("div",{className:"mushaf-arabic",dir:"rtl",children:m.verses.map((a,t)=>{var q;const{surah:l,ayat:d}=P(a.verse_key),g=b&&N===l&&E===d,k=t===0||l!==P(m.verses[t-1].verse_key).surah;return e.jsxs("span",{children:[k&&d===1&&l!==9&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"surah-header",children:e.jsx("span",{className:"surah-header-name",children:(q=L.find(M=>M.nomor===l))==null?void 0:q.nama})}),l!==1&&e.jsx("div",{className:"bismillah",children:"بِسْمِ ٱللَّهِ ٱلرَّحْمَـٰنِ ٱلرَّحِيمِ"})]}),Q?e.jsx("span",{className:`ayat ${g?"playing":""}`,onClick:()=>H(l,d),dangerouslySetInnerHTML:{__html:a.text_tajweed}}):e.jsx("span",{className:`ayat ${g?"playing":""}`,onClick:()=>H(l,d),children:a.text_uthmani}),e.jsxs("span",{className:"ayat-number",children:[e.jsx("span",{className:"num-arabic",children:Fe(d)}),e.jsx("span",{className:"num-sep"}),e.jsx("span",{className:"num-latin",children:d})]})," "]},a.verse_key)})}),e.jsx("div",{className:"mushaf-footer",children:e.jsxs("span",{className:"page-number",children:[e.jsx("span",{className:"page-label",children:i("quran.page")}),e.jsx("span",{className:"page-num",children:h}),e.jsx("span",{className:"page-total",children:"/ 604"})]})})]})}),e.jsx("button",{className:"nav-arrow prev",onClick:()=>h>1&&u(`/quran/mushaf/${h-1}`),disabled:h<=1,children:e.jsx("span",{className:"material-symbols-outlined",children:"chevron_right"})}),e.jsx("button",{className:"nav-arrow next",onClick:()=>h<604&&u(`/quran/mushaf/${h+1}`),disabled:h>=604,children:e.jsx("span",{className:"material-symbols-outlined",children:"chevron_left"})})]}),e.jsx("div",{className:"audio-player",children:e.jsxs("div",{className:"audio-player-inner glass-panel",children:[e.jsxs("div",{className:"audio-progress",children:[e.jsx("span",{className:"time",children:ye($)}),e.jsx("input",{type:"range",min:"0",max:s||100,value:$,onChange:Le,style:{background:s?`linear-gradient(to right, var(--mushaf-primary) 0%, var(--mushaf-primary) ${$/s*100}%, rgba(255,255,255,0.15) ${$/s*100}%, rgba(255,255,255,0.15) 100%)`:"rgba(255,255,255,0.15)"}}),e.jsx("span",{className:"time",children:ye(s)})]}),e.jsxs("div",{className:"audio-controls",children:[e.jsxs("div",{className:"audio-info",children:[e.jsx("div",{className:"audio-icon",children:e.jsx("span",{className:"material-symbols-outlined",children:b?"graphic_eq":"play_arrow"})}),e.jsxs("div",{className:"audio-details",children:[e.jsxs("div",{className:"title",children:[S==null?void 0:S.namaLatin," • ",i("quran.verse")," ",E]}),e.jsx("div",{className:"subtitle",children:(me==null?void 0:me.name)||"Qari"})]})]}),e.jsxs("div",{className:"audio-buttons",children:[e.jsxs("button",{className:"speed-btn",onClick:()=>{const a=B.indexOf(v);ie(B[(a+1)%B.length])},children:[v,"x"]}),e.jsx("button",{className:"audio-btn",onClick:()=>{},children:e.jsx("span",{className:"material-symbols-outlined",children:"skip_previous"})}),e.jsx("button",{className:"audio-btn play",onClick:Me,children:e.jsx("span",{className:"material-symbols-outlined filled",children:b?"pause":"play_arrow"})}),e.jsx("button",{className:"audio-btn",onClick:()=>{},children:e.jsx("span",{className:"material-symbols-outlined",children:"skip_next"})}),e.jsx("button",{className:"audio-btn",onClick:()=>{c.current&&(c.current.pause(),c.current.currentTime=0),w(!1)},children:e.jsx("span",{className:"material-symbols-outlined",children:"stop"})}),e.jsxs("div",{className:"volume-control",children:[e.jsx("span",{className:"material-symbols-outlined",children:A===0?"volume_off":A<.5?"volume_down":"volume_up"}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:A,onChange:a=>ce(parseFloat(a.target.value))})]})]})]})]})}),O&&e.jsx("div",{className:"modal-overlay",onClick:()=>Z(!1),children:e.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:i("quran.jumpToPage")}),e.jsx("button",{onClick:()=>Z(!1),children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsxs("form",{onSubmit:a=>{a.preventDefault();const t=parseInt(fe);t>=1&&t<=604&&(u(`/quran/mushaf/${t}`),Z(!1))},className:"jump-form",children:[e.jsx("input",{type:"number",min:"1",max:"604",value:fe,onChange:a=>Te(a.target.value),placeholder:"1-604"}),e.jsx("button",{type:"submit",children:i("common.go")})]}),e.jsxs("div",{className:"qari-select",children:[e.jsx("label",{children:i("quran.qari")}),e.jsx("select",{value:y,onChange:a=>z(a.target.value),children:he.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))})]})]})})]})}export{ea as default};
